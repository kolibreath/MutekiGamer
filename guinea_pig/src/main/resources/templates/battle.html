<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="referrer" content="no-referrer"/>
    <!-- <meta http-equiv="Content-Type" content="text/html" /> -->
    <meta name="keyword" content="HTML, CSS, image, navigation"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>MutekiGamer - Battle</title>
    <base th:href="@{/}">
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
    <link rel="stylesheet" type="text/css" href="css/login.css"/>
    <link rel="stylesheet" type="text/css" href="css/battle.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-autohidingnavbar/4.0.0/jquery.bootstrap-autohidingnavbar.js"></script>
    <script type="text/javascript" th:src="@{/js/template-web.js}"></script>
    <script type="text/javascript" th:src="@{/js/Homepage.js}"></script>
    <script type="text/javascript" th:src="@{/js/Battle.js}"></script>
    <script type="text/javascript" th:src="@{/js/Team.js}"></script>
    <script type="text/javascript" th:src="@{/js/User.js}"></script>
    <script type="text/javascript" th:src="@{/js/Default.js}"></script>
    <style>
        form {
            position: relative;
            width: 300px;
            margin: 0 auto;
        }
        input, button {
            border: none;
            outline: none;
        }
        input {
            width: 20%;
            height: 42px;
            padding-left: 13px;
        }
        button {
            height: 42px;
            width: 42px;
            cursor: pointer;
            position: absolute;
        }
        /*搜索框7*/
        .bar7 {background: #7BA7AB;}
        .bar7 form {
            height: 42px;
        }
        .bar7 input {
            width: 300px;
            border-radius: 42px;
            border: 2px solid #324B4E;
            background: #F9F0DA;
            /*transition: .3s linear;*/
            float: right;
        }
        .bar7 input:focus {
            width: 300px;
        }
        .bar7 button {
            background: none;
            top: -2px;
            right: 0;
        }
        .bar7 button:before{
            content: "\f002";
            font-family: FontAwesome;
            color: #324b4e;
        }
        .dropdown-menu.show{
            margin-left: -260px !important;
            width: 300px;
        }

    </style>
</head>
<body data-spy="scroll" data-target="#myScrollspy" data-offset="1">
<div class="barContainer">
    <div class="nav-content">
        <div class="nav-title">
                <span>
                    <img src="https://static.dingtalk.com/media/lALPDgQ9rZl6KXPNAljNB0Q_1860_600.png?auth_bizType=IM&auth_bizEntity=%7B%22cid%22%3A%228737273277%22%2C%22msgId%22%3A%222028145409841%22%7D&bizType=im&open_id=267508618"
                         alt="MutekiGamer logo">
                </span>
        </div>
        <div class="nav-text">
            <span style="float: left"><a href="HomePage">主页</a></span>
            <span style="float: left"><a href="/homepage/community">社区</a></span>
            <span style="float: left"><a href="/homepage/news">头条</a></span>
            <span class="active" style="float: left"><a href="/homepage/battle" style="color: #dadada">战场</a></span>
<!--            搜索框-->

            <div class="search bar7" style="float: left;width: 20%;margin-left: 18%;margin-top: 1%;background: none;">
                <form>
                    <input   id="searchContent"  style="background: none;" type="text" placeholder="请输入您要搜索的内容...">
                    <div class="dropdown"></div>
                    <button id="hand_in" type="submit" class="dropdown-toggle" data-toggle="dropdown"></button>
                    <div class="dropdown-menu" style="left: -100px;">
                        <a class="dropdown-item" href="#">Link 1</a>
                        <a class="dropdown-item" href="#">Link 2</a>
                        <a class="dropdown-item" href="#">Link 3</a>
                    </div>
                </form>
            </div>

            <div class="dropdown" style="float: right;margin: 5px 30px;">
                <a href="/homepage/my" id="user_avatar_container">
                    <!--下面的img插用户头像-->
                    <img src="https://static.dingtalk.com/media/lADPDgQ9rbqFW6nNAQLNAQM_259_258.jpg_620x10000q90g.jpg?auth_bizType=IM&auth_bizEntity=%7B%22cid%22%3A%228737273277%22%2C%22msgId%22%3A%222062145382217%22%7D&bizType=im&open_id=267508618" style="width: 50px;height: 50px;border-radius: 50%;">
                </a>
                <a class="dropdown-toggle"  data-toggle="dropdown" style="text-decoration: none;">
                </a>
                <div class="dropdown-menu" >
                    <!--两个跳转-->
                    <a class="dropdown-item" href="/homepage/alter_userinfo">修改信息</a>
                    <a class="dropdown-item" href="#">退出</a>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="gamechose" style="position: sticky;margin-bottom: 80px;top: 0;">
    <div class="card" style="background: rgba(244,244,244,0.8);width: auto; height: 600px;">
        <div class="card-body" style="height: auto;">

            <div class="container">
                <div id="games"></div>
            </div>
        </div>
    </div>
</div>
<div style="width: 50%;float: right;margin-right: 10%;margin-top: 50px;">
    <img src="https://static.dingtalk.com/media/lADPDgQ9rZ-VKL7NAgnNBbA_1456_521.jpg?auth_bizType=IM&auth_bizEntity=%7B%22cid%22%3A%228737273277%22%2C%22msgId%22%3A%222030464972053%22%7D&bizType=im&open_id=267508618">
</div>
<div class="navbars" style="z-index: 22;">
    <nav class="navroll">
        <ul class="nav nav-tabs" role="tablist" style="height: 100%;text-align: center;width: 100%;">
            <li class="nav-item" style="width: 25%;">
                <a class="nav-link active" data-toggle="tab" href="#home" style="height: 100%;">资讯</a>
            </li>
            <li class="nav-item" style="width: 25%">
                <a class="nav-link" data-toggle="tab" href="#menu1" style="height: 100%;">社区</a>
            </li>
            <li class="nav-item" style="width: 25%">
                <a class="nav-link" data-toggle="tab" href="#menu2" style="height: 100%;">战队</a>
            </li>
            <li class="nav-item chosebut">
                <a class="nav-link" data-toggle="tab" href="#menu3" style="height: 100%;">赛事</a>
            </li>
        </ul>
    </nav>
</div>
<!-- <div class="card" style="background: rgba(244,244,244,0.8);width: 50%;float: right;height: auto;margin-right: 10%;margin-top: 50px;"> -->
<div class="tab-content tabchose">
    <!-- 资讯 -->
    <div id="home" class="container tab-pane active">

        <div id="info"></div>
    </div>
    <!-- 社区 -->
    <div id="menu1" class="container tab-pane fade">
        <div id="community"></div>
    </div>
    <!-- 战队 -->
    <div id="menu2" class="container tab-pane fade">
        <div id="team"></div>
    </div>
    <!-- 赛事 -->
    <div id="menu3" class="container tab-pane fade">
        <div id="battle"></div>
    </div>
</div>
<!--处理左侧游戏列表-->
<script id="g" type="text/html">
    <ul class="nav flex-column">
        {{each data}}
        <li style="margin: 20px; height: 80px;">
            <img src="{{$value.picture}}" class="imgsize" style="margin-top: 15px;">
            <a  class="game" style="cursor:pointer;"  id="{{$value.gameId}}"  >{{$value.gameName}}</a>
<!--            <div  class="nav-link gamelink">-->
<!--                <button class="game" id="{{$value.gameId}}" >{{$value.gameName}}</button>-->
<!--            </div>-->
        </li>
        {{/each}}
    </ul>
</script>

<!--处理相应游戏的资讯-->
<script id="info1" type="text/html">
    <ul>
        {{each data}}
        <li>
            <!--发帖人信息-->
            <div>{{$value.userName}}</div>
            <div><img src="{{$value.userAvatar}}" style="width: 50px;height: 50px"></div>
            <!--帖子标题-->
           <a href="/homepage/bbspost/{{$value.postId}}" >
               <div>{{$value.title}}</div>
           </a>
            <!--帖子内容-->
            <div style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">{{$value.content}}</div>
            <!--帖子的时间-->
            <div>{{$value.time}}</div>
        </li>
        {{/each}}
    </ul>
</script>

<script id="info2" type="text/html">
    <ul>
        {{each data}}
        <li>
            <!--发帖人信息-->
            <div>{{$value.userName}}</div>
            <!--<div><img src="{{$value.userAvatar}}" style="width: 50px;height: 50px"></div>-->
            <!--&lt;!&ndash;帖子标题&ndash;&gt;-->
            <a href="/homepage/bbspost/{{$value.postId}}" >
                <div>{{$value.title}}</div>
            </a>
            <!--帖子内容-->
            <div style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">{{$value.content}}</div>
            <!--帖子的时间-->
            <div>{{$value.time}}</div>
        </li>
        {{/each}}
    </ul>
</script>
<!--处理相应游戏的社区信息-->
<script id="communities" type="text/html">
    <ul>
        {{each data}}
        <li>
            <!--帖子标题-->
            <h1 class="titledetail">
                <a href="/homepage/bbspost/{{$value.postId}}" target="_blank" style="text-decoration: none;" >
                    <div>{{$value.title}}</div>
                </a>
            </h1>
            <!--帖子内容-->
            <p class="newsdetail">
                <div style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">{{$value.content}}</div>
            </p>
            <!--发帖人信息，头像先不要-->
            <div>
                <a>{{$value.userName}}</a>
                <span style="float: right;">{{$value.time}}</span>
            </div>
        </li>
        {{/each}}
    </ul>
</script>
<!--处理相应游戏的战队信息-->
<script id="teams" type="text/html">
    <ul>
        {{each data}}
        <li class="clublist" style="float: left;width: 46.5%;height: 220px;">

            <div><img src="{{$value.avatar}}" style="width: 50%; height: auto; border-radius: 50%"></div>
            <div style="margin-top: 8px;"><a style="text-decoration: none;" href="/homepage/teaminfo/{{$value.teamId}}">{{$value.teamName}}</a></div>
        </li>
        {{/each}}
    </ul>
</script>

<!--处理相应游戏的赛事信息-->
<script id="battles" type="text/html">
<ul>
    {{each data}}
    <li class="clublist" style="padding-top: 0px;">
        <p class="battlemsg">
            <span style="float: left;">
                {{if $value.status==1}}
                已结束
                {{else}}
                未结束
                {{/if}}
            </span>
            <span style="float: right;margin-right: 10px;">{{$value.time}}</span>
        </p>
        <div class="gameteama" style="overflow: visible;margin-left: 0px;">
            <span>
                <a target="_blank" style="margin-left: 20px;">
                    <img src="{{$value.teamAvatar1}}">
                </a>
            </span>
            <span style="display: inline-block;word-wrap: break-word;word-break: normal;width: 80px;margin-left: 10px;">
                <a>{{$value.teamName1}}</a>
            </span>

        </div>
        <div class="gameteamb" style="overflow: visible; margin-right: 40px;">
            <span>
                <a target="_blank">
                    <img style="margin-left: 20px;" src="{{$value.teamAvatar2}}">
                </a>
            </span>
            <span style="display: inline-block;word-wrap: break-word;word-break: normal;width: 90px;margin-right: 10px;padding-top: 25px;">
                <a>{{$value.teamName2}}</a>
            </span>
        </div>
        <span class="gamelist-score">
            <a style="color: white;">{{$value.teamScore1}}</a>
            <a class="win">{{$value.teamScore2}}</a>
        </span>
    </li>
    {{/each}}
</ul>
</script>

<!--请求左侧游戏列表-->
<script>
    var games = {};
    homepage(function (result) {
        games = result.game;

        var html = template('g', games);
        document.getElementById('games').innerHTML = html;

        // 显示默认的游戏帖子
        officalDefault(function (result) {
            var posts=result.post;
            console.log(posts);
            // 默认资讯
            var html = template('info2', posts);
            document.getElementById('info').innerHTML = html;

        });

        var infos = {};
        var comm = {};
        var teams = {};
        var matches = {};

        $(".game").click(function () {
            // 获取点击的游戏Id
            let val = $(this).attr("id");

            //游戏的资讯
            news(val, function (result) {
                infos = result.post;
                var html = template('info1', infos);
                document.getElementById('info').innerHTML = html;
            });

            //游戏的社区
            getPostByGameId(val, function (result) {
                comm = result.post;
                var html = template('communities', comm);
                // console.log(html);
                document.getElementById('community').innerHTML = html;
            });

            //游戏的战队
            getTeamInfo(val, function (result) {
                teams = result.result;
                var html = template('teams', teams);
                // console.log(html);
                document.getElementById('team').innerHTML = html;

            });
            // 游戏的赛事
            match(val,function (result) {
                matches=result.result;
                console.log(matches);
                var html = template('battles',matches);
                console.log(html);
                document.getElementById('battle').innerHTML = html;
            });
        })
    });

    getUserInfo(function(result){
        let userInfo = result.data;
        $("#user_avatar_container").html(" <!--下面的img插用户头像-->\n" +
            "                    <img src=\""+userInfo.userAvatar+"\" style=\"width: 50px;height: 50px;border-radius: 50%;\">\n");
    });
</script>


<footer style="position: relative;height: 60px;background-color:#5E5E5E; color:  #EAEAEA;overflow: hidden;" >

    <div style="height:50px;width: 180px;margin-left: 30%;float: left;">
        <img src="https://static.dingtalk.com/media/lALPDgQ9rZmS1SDNAcLNB0Q_1860_450.png?auth_bizType=IM&auth_bizEntity=%7B%22cid%22%3A%228737273277%22%2C%22msgId%22%3A%222028305227287%22%7D&bizType=im&open_id=267508618">
    </div>
    <div style="float: left; padding-top: 25px;padding-left: 80px;">
        <p style="float: left;font-weight: 200;font-size: 14px;">@MutekiGamer 2020</p>

        <p style="float: left;margin-left: 70px;font-weight: 200;font-size: 14px;">联系我们:&nbsp&nbspmuteki_gamer@163.com</p>
    </div>
</footer>

</body>
</html>